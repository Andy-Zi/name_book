\documentclass{article}
\usepackage{blindtext}
\usepackage[paperheight=407pt,paperwidth=651pt,margin=1.45cm]{geometry}
\usepackage[pages=all]{background}
\usepackage{tikz}
\usepackage{fontspec}
\usetikzlibrary{decorations.markings,calc}
\usetikzlibrary{shadows}
\usetikzlibrary{calc,decorations.pathmorphing,patterns}
\usepackage{hyperref}

\setmainfont{Sacramento}

\input{names.tex}
% \def\Girls{Hannah}
% \def\Boys{Fabian}
\pagenumbering{gobble}

\definecolor{bookcolor}{RGB}{79, 85, 4}
\definecolor{markerGirls}{RGB}{121, 26, 61}
\definecolor{markerBoys}{RGB}{1, 110, 143}

\pgfdeclaredecoration{penciline}{initial}{
    \state{initial}[width=+\pgfdecoratedinputsegmentremainingdistance,auto corner on length=1mm,]{
        \pgfpathcurveto%
        {% From
            \pgfqpoint{\pgfdecoratedinputsegmentremainingdistance}
                            {\pgfdecorationsegmentamplitude}
        }
        {%  Control 1
        \pgfmathrand
        \pgfpointadd{\pgfqpoint{\pgfdecoratedinputsegmentremainingdistance}{0pt}}
                        {\pgfqpoint{-\pgfdecorationsegmentaspect\pgfdecoratedinputsegmentremainingdistance}%
                                        {\pgfmathresult\pgfdecorationsegmentamplitude}
                        }
        }
        {%TO 
        \pgfpointadd{\pgfpointdecoratedinputsegmentlast}{\pgfpoint{1pt}{1pt}}
        }
    }
    \state{final}{}
}
\newsavebox{\NameBox}
\newsavebox{\SubjectsSmallBox}
\newsavebox{\SubjectsMediumBox}
\newsavebox{\SubjectsBigBox}
\newsavebox{\SubjectsGiantBox}

\newcommand{\updateNameBox}{
    \savebox{\NameBox}{
      \begin{tikzpicture}[decoration=penciline]
        \node[decorate,draw, minimum height=1cm, minimum width=5cm, line width=2pt] {};
      \end{tikzpicture}
    }
}
\newcommand{\updateSubjectsSmallBox}{
    \savebox{\SubjectsSmallBox}{
      \begin{tikzpicture}[decoration=penciline]
        \node[decorate,draw, minimum height=3.5cm, minimum width=3cm, line width=1pt] {};
        \node[decorate,draw, minimum height=3.5cm, minimum width=3cm, line width=1pt,xshift=3cm] {};
        \node[decorate,draw, minimum height=3.5cm, minimum width=3cm, line width=1pt,xshift=6cm] {};
      \end{tikzpicture}
    }
}
\newcommand{\updateSubjectsMediumBox}{
    \savebox{\SubjectsMediumBox}{
      \begin{tikzpicture}[decoration=penciline]
        \node[decorate,draw, minimum height=3cm, minimum width=9cm, line width=1pt] {};
      \end{tikzpicture}
    }
}
\newcommand{\updateSubjectsBigBox}{
    \savebox{\SubjectsBigBox}{
      \begin{tikzpicture}[decoration=penciline]
        \node[decorate,draw, minimum height=3.5cm, minimum width=9cm, line width=1pt] {};
      \end{tikzpicture}
    }
}
\newcommand{\updateSubjectsGiantBox}{
    \savebox{\SubjectsGiantBox}{
      \begin{tikzpicture}[decoration=penciline]
        \node[decorate,draw, minimum height=11cm, minimum width=9cm, line width=1pt] {};
      \end{tikzpicture}
    }
}

\def\Step{0.25}  %% separation between dots
\def\Size{0.1pt}    %% radius of the dot

\newsavebox{\PaperPaternbox}
\sbox{\PaperPaternbox}{
\begin{tikzpicture}[remember picture]
    \foreach \y in {1,2,...,60}{
        \foreach \x in {1,2,...,60}
          \draw[fill=black,opacity=0.3,shift={(\Step*\x cm,\Step*\y cm)}] (0,) circle[radius=\Size];
    }
\end{tikzpicture}
}

\backgroundsetup{
scale=1,
color=black,
opacity=1,
angle=0,
contents={
    \begin{tikzpicture}[remember picture,overlay]
        % Wood background
        \node[anchor=south west,inner sep=0] (background) at (current page.south west) {\includegraphics[width=\paperwidth,height=\paperheight]{./images/wood.JPG}};
        % Outer book cover
        \fill[bookcolor, drop shadow={shadow xshift=0.05cm, shadow yshift=-0.05cm, fill=black, opacity=0.5}] ([xshift=0.6cm,yshift=0.6cm]current page.south west) rectangle ([xshift=-0.6cm,yshift=-0.6cm]current page.north east);
        % Marker for navigation
        \foreach \name [count=\i] in \Girls {
            \draw[rounded corners, fill=markerGirls, draw=black] ([xshift=.25cm,yshift=-.5cm-\i*0.825cm]current page.north west) rectangle ([xshift=3cm,yshift=-1.25cm-\i*0.825cm]current page.north west);
            \node[anchor=west] at ([xshift=.25cm,yshift=-0.825cm-\i*0.825cm]current page.north west) {\hyperlink{Girls\i}{\fontspec{Coming Soon}\name}};
            % Place a node with the hyperlink over the rectangle. The hyperlink target is now dynamically generated.
            \node[anchor=west, minimum height=0.75cm, minimum width=1.2cm] at ([xshift=0cm,yshift=-0.875cm-\i*0.825cm]current page.north west) {\hyperlink{Girls\i}{\phantom{\name}}};
        }
        \foreach \name [count=\i] in \Boys {
            \draw[rounded corners, fill=markerBoys, draw=black] ([xshift=-.25cm,yshift=-.5cm-\i*0.825cm]current page.north east) rectangle ([xshift=-3cm,yshift=-1.25cm-\i*0.825cm]current page.north east);
            \node[anchor=west] at ([xshift=-1.25cm,yshift=-0.825cm-\i*0.825cm]current page.north east) {\hyperlink{Boys\i}{\fontspec{Coming Soon}\name}};
            % Place a node with the hyperlink over the rectangle. The hyperlink target is now dynamically generated.
            \node[anchor=west, minimum height=0.75cm, minimum width=1.2cm] at ([xshift=-1.2cm,yshift=-0.875cm-\i*0.825cm]current page.north east) {\hyperlink{Boys\i}{\phantom{\name}}};
        }
        % Left white rectangle (paper page)
        \fill[white] ([xshift=1.2cm,yshift=1.2cm]current page.south west) rectangle ([xshift=-0.5\paperwidth-0.1cm,yshift=-1.2cm]current page.north east);
        % Right white rectangle (paper page)
        \fill[white] ([xshift=0.5\paperwidth+0.15cm,yshift=1.2cm]current page.south west) rectangle ([xshift=-1.2cm,yshift=-1.2cm]current page.north east);
        % Add points to the left white rectangle
        \begin{scope}
            \clip ([xshift=1.2cm,yshift=1.2cm]current page.south west) rectangle ([xshift=-0.5\paperwidth-0.2cm,yshift=-1.2cm]current page.north east);
            \node at ([xshift=-0.25\paperwidth]current page.center) {\usebox\PaperPaternbox};
        \end{scope}
        % Add points to the right white rectangle
        \begin{scope}
            \clip ([xshift=0.5\paperwidth+0.15cm,yshift=1.2cm]current page.south west) rectangle ([xshift=-1.2cm,yshift=-1.2cm]current page.north east);
            \node at ([xshift=0.25\paperwidth]current page.center) {\usebox\PaperPaternbox};
        \end{scope}
        % Inner book cover
        \node[anchor=center,inner sep=0] at (current page.center) {\includegraphics[width=\paperwidth,height=\paperheight]{./images/ringbinder.png}};
    \end{tikzpicture}
  }
}

\begin{document}

\foreach \name [count=\i] in \Girls {
	\hypertarget{Girls\i}{}
	% \section*{\name}
	\begin{tikzpicture}[remember picture,overlay]
		\node[anchor=north west, xshift=0.96cm, yshift=-1.4cm] at (current page.north west) {
			\begin{tikzpicture}[decoration=penciline]
				% Name box
				\updateNameBox
				\begin{scope}[shift={(0.05cm,-0.05cm)},black!50,opacity=0.5]
					\node at (0.25cm,0.25cm) {\usebox\NameBox};
				\end{scope}
				\node at (0.25cm,0.25cm) {\usebox\NameBox};
				\node at (0.5cm,-0.1cm) {\fontsize{20}{22}\fontspec{Coming Soon} \name};
				% Subjects box Maths
				\updateSubjectsMediumBox
				\begin{scope}[shift={(0.03cm,-0.03cm)},black!50,opacity=0.5]
					\node at (0.25cm,-1.25cm) {\usebox\SubjectsMediumBox};
				\end{scope}
				\node at (0.25cm,-1.25cm) {\usebox\SubjectsMediumBox};
				\node at (0.5cm,-1.565cm) {\fontsize{14}{16} Mathe};
				% Subjects box German
				\updateSubjectsMediumBox
				\begin{scope}[shift={(0.03cm,-0.03cm)},black!50,opacity=0.5]
					\node at (0.25cm,-4.5cm) {\usebox\SubjectsMediumBox};
				\end{scope}
				\node at (0.25cm,-4.5cm) {\usebox\SubjectsMediumBox};
				\node at (0.5cm,-4.815cm) {\fontsize{14}{16} Deutsch};
				% Subjects box HSU
				\updateSubjectsMediumBox
				\begin{scope}[shift={(0.03cm,-0.03cm)},black!50,opacity=0.5]
					\node at (0.25cm,-7.75cm) {\usebox\SubjectsMediumBox};
				\end{scope}
				\node at (0.25cm,-7.75cm) {\usebox\SubjectsMediumBox};
				\node at (0.5cm,-8.05cm) {\fontsize{14}{16} HSU};
			\end{tikzpicture}
		};
		\node[anchor=north west, xshift=0.245cm, yshift=-1.4cm] at (current page.north) {
			\begin{tikzpicture}[decoration=penciline]
				% Subjects box Music Art WG
				\updateSubjectsSmallBox
				\begin{scope}[shift={(0.03cm,-0.03cm)},black!50,opacity=0.5]
					\node at (0.25cm,0.25cm) {\usebox\SubjectsSmallBox};
				\end{scope}
				\node at (0.25cm,0.25cm) {\usebox\SubjectsSmallBox};
				\node at (0.5cm,-0.05cm) {\fontsize{14}{16} Musik};
				\node at (3.5cm,-0.05cm) {\fontsize{14}{16} Kunst};
				\node at (6.5cm,-0.05cm) {\fontsize{14}{16} WG};
				% Subjects box Lern und Arbeitsverhalten
				\updateSubjectsBigBox
				\begin{scope}[shift={(0.03cm,-0.03cm)},black!50,opacity=0.5]
					\node at (0.25cm,-3.5cm) {\usebox\SubjectsBigBox};
				\end{scope}
				\node at (0.25cm,-3.5cm) {\usebox\SubjectsBigBox};
				\node at (0.5cm,-3.8cm) {\fontsize{14}{16} Lern- und Arbeitsverhalten};
				% Subjects box Soziales Verhalten
				\updateSubjectsBigBox
				\begin{scope}[shift={(0.03cm,-0.03cm)},black!50,opacity=0.5]
					\node at (0.25cm,-7.25cm) {\usebox\SubjectsBigBox};
				\end{scope}
				\node at (0.25cm,-7.25cm) {\usebox\SubjectsBigBox};
				\node at (0.5cm,-7.55cm) {\fontsize{14}{16} Soziales Verhalten};
			\end{tikzpicture}
		};
	\end{tikzpicture}
	% Any additional content for \name's page
	\newpage % Start a new page for the next name
	\begin{tikzpicture}[remember picture,overlay]
		\node[anchor=north west, xshift=0.96cm, yshift=-1.4cm] at (current page.north west) {
			\begin{tikzpicture}[decoration=penciline]
				% Sonstiges
				\updateSubjectsGiantBox
				\begin{scope}[shift={(0.03cm,-0.03cm)},black!50,opacity=0.5]
					\node at (0.25cm,0.25cm) {\usebox\SubjectsGiantBox};
				\end{scope}
				\node at (0.25cm,0.25cm) {\usebox\SubjectsGiantBox};
				\node at (0.5cm,-0.05cm) {\fontsize{14}{16} Sonstiges};
			\end{tikzpicture}
		};
		\node[anchor=north west, xshift=0.245cm, yshift=-1.4cm] at (current page.north) {
			\begin{tikzpicture}[decoration=penciline]
				% Eltern
				\updateSubjectsGiantBox
				\begin{scope}[shift={(0.03cm,-0.03cm)},black!50,opacity=0.5]
					\node at (0.25cm,0.25cm) {\usebox\SubjectsGiantBox};
				\end{scope}
				\node at (0.25cm,0.25cm) {\usebox\SubjectsGiantBox};
				\node at (0.5cm,-0.05cm) {\fontsize{14}{16} Eltern};
			\end{tikzpicture}
		};
	\end{tikzpicture}
    \newpage % Start a new page for the next name
}

\foreach \name [count=\i] in \Boys {
	\hypertarget{Boys\i}{}
	\begin{tikzpicture}[remember picture,overlay]
		\node[anchor=north west, xshift=0.96cm, yshift=-1.4cm] at (current page.north west) {
			\begin{tikzpicture}[decoration=penciline]
				% Name box
				\updateNameBox
				\begin{scope}[shift={(0.05cm,-0.05cm)},black!50,opacity=0.5]
					\node at (0.25cm,0.25cm) {\usebox\NameBox};
				\end{scope}
				\node at (0.25cm,0.25cm) {\usebox\NameBox};
				\node at (0.5cm,-0.1cm) {\fontsize{20}{22}\fontspec{Coming Soon} \name};
				% Subjects box Maths
				\updateSubjectsMediumBox
				\begin{scope}[shift={(0.03cm,-0.03cm)},black!50,opacity=0.5]
					\node at (0.25cm,-1.25cm) {\usebox\SubjectsMediumBox};
				\end{scope}
				\node at (0.25cm,-1.25cm) {\usebox\SubjectsMediumBox};
				\node at (0.5cm,-1.565cm) {\fontsize{14}{16} Mathe};
				% Subjects box German
				\updateSubjectsMediumBox
				\begin{scope}[shift={(0.03cm,-0.03cm)},black!50,opacity=0.5]
					\node at (0.25cm,-4.5cm) {\usebox\SubjectsMediumBox};
				\end{scope}
				\node at (0.25cm,-4.5cm) {\usebox\SubjectsMediumBox};
				\node at (0.5cm,-4.815cm) {\fontsize{14}{16} Deutsch};
				% Subjects box HSU
				\updateSubjectsMediumBox
				\begin{scope}[shift={(0.03cm,-0.03cm)},black!50,opacity=0.5]
					\node at (0.25cm,-7.75cm) {\usebox\SubjectsMediumBox};
				\end{scope}
				\node at (0.25cm,-7.75cm) {\usebox\SubjectsMediumBox};
				\node at (0.5cm,-8.05cm) {\fontsize{14}{16} HSU};
			\end{tikzpicture}
		};
		\node[anchor=north west, xshift=0.245cm, yshift=-1.4cm] at (current page.north) {
			\begin{tikzpicture}[decoration=penciline]
				% Subjects box Music Art WG
				\updateSubjectsSmallBox
				\begin{scope}[shift={(0.03cm,-0.03cm)},black!50,opacity=0.5]
					\node at (0.25cm,0.25cm) {\usebox\SubjectsSmallBox};
				\end{scope}
				\node at (0.25cm,0.25cm) {\usebox\SubjectsSmallBox};
				\node at (0.5cm,-0.05cm) {\fontsize{14}{16} Musik};
				\node at (3.5cm,-0.05cm) {\fontsize{14}{16} Kunst};
				\node at (6.5cm,-0.05cm) {\fontsize{14}{16} WG};
				% Subjects box Lern und Arbeitsverhalten
				\updateSubjectsBigBox
				\begin{scope}[shift={(0.03cm,-0.03cm)},black!50,opacity=0.5]
					\node at (0.25cm,-3.5cm) {\usebox\SubjectsBigBox};
				\end{scope}
				\node at (0.25cm,-3.5cm) {\usebox\SubjectsBigBox};
				\node at (0.5cm,-3.8cm) {\fontsize{14}{16} Lern- und Arbeitsverhalten};
				% Subjects box Soziales Verhalten
				\updateSubjectsBigBox
				\begin{scope}[shift={(0.03cm,-0.03cm)},black!50,opacity=0.5]
					\node at (0.25cm,-7.25cm) {\usebox\SubjectsBigBox};
				\end{scope}
				\node at (0.25cm,-7.25cm) {\usebox\SubjectsBigBox};
				\node at (0.5cm,-7.55cm) {\fontsize{14}{16} Soziales Verhalten};
			\end{tikzpicture}
		};
	\end{tikzpicture}
	% Any additional content for \name's page
	\newpage % Start a new page for the next name
	\begin{tikzpicture}[remember picture,overlay]
		\node[anchor=north west, xshift=0.96cm, yshift=-1.4cm] at (current page.north west) {
			\begin{tikzpicture}[decoration=penciline]
				% Sonstiges
				\updateSubjectsGiantBox
				\begin{scope}[shift={(0.03cm,-0.03cm)},black!50,opacity=0.5]
					\node at (0.25cm,0.25cm) {\usebox\SubjectsGiantBox};
				\end{scope}
				\node at (0.25cm,0.25cm) {\usebox\SubjectsGiantBox};
				\node at (0.5cm,-0.05cm) {\fontsize{14}{16} Sonstiges};
			\end{tikzpicture}
		};
		\node[anchor=north west, xshift=0.245cm, yshift=-1.4cm] at (current page.north) {
			\begin{tikzpicture}[decoration=penciline]
				% Eltern
				\updateSubjectsGiantBox
				\begin{scope}[shift={(0.03cm,-0.03cm)},black!50,opacity=0.5]
					\node at (0.25cm,0.25cm) {\usebox\SubjectsGiantBox};
				\end{scope}
				\node at (0.25cm,0.25cm) {\usebox\SubjectsGiantBox};
				\node at (0.5cm,-0.05cm) {\fontsize{14}{16} Eltern};
			\end{tikzpicture}
		};
	\end{tikzpicture}
    \newpage % Start a new page for the next name
}
\end{document}
